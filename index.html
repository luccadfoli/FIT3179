<!DOCTYPE html>
<html>
<head>
  <title>Using solar panels in Australia</title>

  <!-- Vega stack -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

  <!-- Pure.css (core + responsive grid) -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css" crossorigin="anonymous">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

  <!-- Page CSS -->
  <style>
    html, body { margin: 0; max-width: 100%; overflow-x: hidden; font-family: 'Open Sans', sans-serif; }
    * { box-sizing: border-box; }

    /* Center the content, add side borders, and cap width */
    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 20px 32px;
      border-left: 4px solid #eaeaea;
      border-right: 4px solid #eaeaea;
      background: #fff;
    }

    h1 { margin: 24px 0 6px; }
    p { line-height: 1.6; }

    .vis-container { width: 100%; }
    img, svg, canvas { max-width: 100%; height: auto; display: block; }

    /* add a bit of space between columns/rows */
    .pure-g { gap: 18px; }

    .small-font { font-size: 0.9rem; color: #555; }
  </style>
</head>

<body>
  <div class="page">

    <!-- Title -->
    <div class="pure-g">
      <div class="pure-u-1">
        <h1>Using solar panels in Australia</h1>
        <p>The best places to set up photovoltaic solar panels in Australia</p>
      </div>
    </div>

    <!-- ROW 1: text + vis1 -->
    <div class="pure-g">
      <div class="pure-u-1 pure-u-md-1-2">
        <div class="description">
          <h2>Residential usage of solar panels</h2>
          <p>
            Roughly 38% of homes across Australia now generate their own solar power.
            South Australia and Queensland lead the transition with more than half of households
            equipped with rooftop solar systems. Western Australia follows closely at 46.98%.
          </p>
        </div>
      </div>
      <div class="pure-u-1 pure-u-md-1-2">
        <div id="vis1" class="vis-container"></div>
      </div>
    </div>

    <!-- ROW 2: map (left) + line (right) -->
    <div class="pure-g">
      <div class="pure-u-1 pure-u-md-1-2">
        <div id="vis2" class="vis-container"></div>
      </div>
      <div class="pure-u-1 pure-u-md-1-2">
        <div id="vis3" class="vis-container"></div>
      </div>
    </div>

    <!-- Footer -->
    <div class="pure-g">
      <div class="pure-u-1 small-font">
        <p>
          This visualisation is created by
          <a href="https://fit3179.github.io/Vega-Lite/" target="_blank">FIT3179 Teaching Team</a>.
          The datasource is <a href="#" target="_blank">some data repository online</a>.
        </p>
      </div>
    </div>

  </div> <!-- end .page -->

  <script>
    /* ---------- vis1: bar chart (states) ---------- */
    var specVis1 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": "Percentage of Homes with Solar Panels per State",
      "width": "container",
      "height": 320,
      "autosize": {"type": "fit", "contains": "padding"},
      "data": {
        "values": [
          {"State": "ACT", "Homes with Solar (%)": 33.21},
          {"State": "NSW", "Homes with Solar (%)": 32.10},
          {"State": "NT",  "Homes with Solar (%)": 25.31},
          {"State": "QLD", "Homes with Solar (%)": 50.85},
          {"State": "SA",  "Homes with Solar (%)": 53.29},
          {"State": "TAS", "Homes with Solar (%)": 23.54},
          {"State": "VIC", "Homes with Solar (%)": 29.19},
          {"State": "WA",  "Homes with Solar (%)": 46.98}
        ]
      },
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "State", "type": "nominal",
          "axis": {"labelAngle": 0, "labelPadding": 10},
          "scale": {"paddingInner": 0.5, "paddingOuter": 0.25}
        },
        "y": {"field": "Homes with Solar (%)", "type": "quantitative"},
        "tooltip": [
          {"field": "State"},
          {"field": "Homes with Solar (%)", "type": "quantitative", "format": ".2f", "title": "Homes with Solar (%)"}
        ]
      }
    };

    /* ---------- vis3: line chart (installs by year) ---------- */
    var specVis3 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title":"Solar Systems Installed per Year",
      "width": "container",
      "height": 320,
      "autosize": {"type": "fit", "contains": "padding"},
      "data": {
        "values": [
          {"Year": "2016", "Solar Systems Installed": 132697},
          {"Year": "2017", "Solar Systems Installed": 174942},
          {"Year": "2018", "Solar Systems Installed": 224852},
          {"Year": "2019", "Solar Systems Installed": 284031},
          {"Year": "2020", "Solar Systems Installed": 370320},
          {"Year": "2021", "Solar Systems Installed": 377458},
          {"Year": "2022", "Solar Systems Installed": 315717},
          {"Year": "2023", "Solar Systems Installed": 333859},
          {"Year": "2024", "Solar Systems Installed": 317348},
          {"Year": "2025", "Solar Systems Installed": 95393}
        ]
      },
      "mark": {"type": "line", "point": true},
      "encoding": {
        "x": {"field": "Year", "type": "ordinal", "axis": {"labelAngle": 0}},
        "y": {"field": "Solar Systems Installed", "type": "quantitative"},
        "tooltip": [
          {"field": "Year"},
          {"field": "Solar Systems Installed", "type": "quantitative", "title": "Solar Systems Installed"}
        ]
      }
    };

    /* ---------- vis2: map (sunshine grid) ---------- */
    var specVis2 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {"text": "Average Sunlight Hours in Australia", "fontSize": 20, "fontWeight": "bold", "dy": 8},
      "width": "container",
      "height": 520,
      "autosize": {"type": "fit", "contains": "padding"},
      "params": [
        {"name": "Melbourne", "value": false, "bind": {"input": "checkbox", "label": "Zoom in"}},
        {"name": "Ocean", "value": false, "bind": {"input": "checkbox", "label": "Make oceans transparent"}},
        {
          "name": "valFilter","value": "All",
          "bind": {
            "input": "select","name": "Show value: ",
            "options": ["All","0","1","2","3","4","5","6","7","8","9","10"],
            "labels":  ["All","0","1","2","3","4","5","6","7","8","9","10"]
          }
        }
      ],
      "layer": [
        {
          "projection": {"type": "mercator", "center": [135, -26], "scale": 900},
          "layer": [
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/grid_cellsFINAL.json",
                "format": {"type": "topojson", "feature": "grid_cellsFINAL"}
              },
              "transform": [
                {"filter": "Melbourne == false"},
                {"calculate": "toNumber(datum.id)", "as": "gid_num"},
                {
                  "lookup": "gid_num",
                  "from": {
                    "data": {
                      "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/sunann_gridvals.csv",
                      "format": {"type": "csv", "parse": {"grid_id":"number","value":"number"}}
                    },
                    "key": "grid_id", "fields": ["value"]
                  }
                },
                {"calculate": "round(datum.value)", "as": "val_int"},
                {"filter": "valFilter == 'All' || datum.val_int == toNumber(valFilter)"}
              ],
              "mark": {"type": "geoshape", "clip": true},
              "encoding": {
                "color": {"field": "val_int", "type": "ordinal", "title": "Sunshine (h)", "scale": {"scheme": "inferno"}},
                "stroke": {"value": "#999"}, "strokeWidth": {"value": 0},
                "tooltip": [{"field": "val_int", "type": "ordinal", "title": "Sunshine (h)"}]
              }
            },
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/refs/heads/main/oceans%20(1).json",
                "format": {"type": "topojson", "feature": "oceans"}
              },
              "transform": [{"filter": "Melbourne == false"}],
              "mark": {"type": "geoshape", "fill": "#ffffff", "clip": true},
              "encoding": { "opacity": {"condition": {"param": "Ocean", "value": 0}, "value": 1} }
            },
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/Level2_Australia%20(1).json",
                "format": {"type": "topojson", "feature": "Level2_Australia"}
              },
              "transform": [{"filter": "Melbourne == false"}],
              "mark": {"type": "geoshape", "fill": null, "stroke": "#000000", "strokeWidth": 0.8, "clip": true},
              "encoding": {"tooltip": [{"field": "properties.SA3_NAME21", "title": "SA3"}]}
            }
          ]
        },

        /* Zoomed view when "Melbourne" is checked */
        {
          "projection": {"type": "mercator", "center": [145, -37.8], "scale": 8000},
          "layer": [
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/grid_cellsFINAL.json",
                "format": {"type": "topojson", "feature": "grid_cellsFINAL"}
              },
              "transform": [
                {"filter": "Melbourne == true"},
                {"calculate": "toNumber(datum.id)", "as": "gid_num"},
                {
                  "lookup": "gid_num",
                  "from": {
                    "data": {
                      "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/sunann_gridvals.csv",
                      "format": {"type": "csv", "parse": {"grid_id":"number","value":"number"}}
                    },
                    "key": "grid_id", "fields": ["value"]
                  }
                },
                {"calculate": "round(datum.value)", "as": "val_int"},
                {"filter": "valFilter == 'All' || datum.val_int == toNumber(valFilter)"}
              ],
              "mark": {"type": "geoshape", "clip": true},
              "encoding": {
                "color": {"field": "val_int", "type": "ordinal", "title": "Sunshine (h)", "scale": {"scheme": "inferno"}},
                "stroke": {"value": "#999"}, "strokeWidth": {"value": 0},
                "tooltip": [
                  {"field": "gid_num", "title": "Grid ID"},
                  {"field": "val_int", "type": "ordinal", "title": "Sunshine (h)"}
                ]
              }
            },
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/refs/heads/main/oceans%20(1).json",
                "format": {"type": "topojson", "feature": "oceans"}
              },
              "transform": [{"filter": "Melbourne == true"}],
              "mark": {"type": "geoshape", "fill": "#ffffff", "clip": true},
              "encoding": { "opacity": {"condition": {"param": "Ocean", "value": 0}, "value": 1} }
            },
            {
              "data": {
                "url": "https://raw.githubusercontent.com/luccadfoli/FIT3179/main/Level2_Australia%20(1).json",
                "format": {"type": "topojson", "feature": "Level2_Australia"}
              },
              "transform": [{"filter": "Melbourne == true"}],
              "mark": {"type": "geoshape", "fill": null, "stroke": "#000000", "strokeWidth": 0.8, "clip": true},
              "encoding": {"tooltip": [{"field": "properties.SA3_NAME21", "title": "SA3"}]}
            }
          ]
        }
      ]
    };

    /* Embed in order: vis1 (row1), vis2 left (row2), vis3 right (row2) */
    vegaEmbed('#vis1', specVis1, {actions: false}).catch(console.error);
    vegaEmbed('#vis2', specVis2, {actions: false}).catch(console.error);
    vegaEmbed('#vis3', specVis3, {actions: false}).catch(console.error);
  </script>
</body>
</html>
